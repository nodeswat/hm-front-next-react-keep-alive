Forked and fixed for hm-front-next
